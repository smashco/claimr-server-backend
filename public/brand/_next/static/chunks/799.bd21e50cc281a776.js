"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[418,799],{6418:(e,t,r)=>{r.r(t),r.d(t,{default:()=>p});var a=r(5155),l=r(2115),s=r(719),o=r(8340);let n=(0,o.A)("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),i=(0,o.A)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),d=(0,o.A)("type",[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]]),c=(0,o.A)("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]),u=(0,o.A)("mouse-pointer-2",[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]]),h=(0,o.A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),x=(0,o.A)("undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]),g=(0,o.A)("redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]),f=(0,o.A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),m=(0,o.A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);function p({territory:e,onSave:t,onCancel:r}){let o=(0,l.useRef)(null),p=(0,l.useRef)(null),[b,y]=(0,l.useState)(null),[v,j]=(0,l.useState)(null),[k,w]=(0,l.useState)("#ffffff"),[N,A]=(0,l.useState)(!1);(0,l.useEffect)(()=>{if(!o.current)return;console.log("[DesignEditor] Territory data:",e),console.log("[DesignEditor] Geometry:",e.geometry);let t=90,r=-90,a=180,l=-180;e.geometry&&e.geometry.coordinates?e.geometry.coordinates[0].forEach(e=>{let s=e[0],o=e[1];o<t&&(t=o),o>r&&(r=o),s<a&&(a=s),s>l&&(l=s)}):console.error("[DesignEditor] ERROR: No geometry data found for territory!",e);let n=l-a,i=r-t;if(console.log("[DesignEditor] Bounds:",{minLat:t,maxLat:r,minLng:a,maxLng:l,geoWidth:n,geoHeight:i}),!p.current)return;let d=p.current.clientWidth,c=p.current.clientHeight,u=new s.Hl(o.current,{width:d,height:c,backgroundColor:"#111827",selection:!1,preserveObjectStacking:!0});if(y(u),u.on("selection:created",e=>j(e.selected?.[0]||null)),u.on("selection:updated",e=>j(e.selected?.[0]||null)),u.on("selection:cleared",()=>j(null)),e.geometry&&e.geometry.coordinates){let t=e.geometry.coordinates[0].map(e=>{let t=e[0],l=e[1];return{x:(t-a)/n*d,y:(r-l)/i*c}});u.clipPath=new s.tS(t,{left:0,top:0,originX:"left",originY:"top",absolutePositioned:!0});let l=new s.tS(t,{left:0,top:0,fill:"transparent",stroke:"#3b82f6",strokeWidth:2,strokeDashArray:[10,10],selectable:!1,evented:!1,absolutePositioned:!0,opacity:.5});u.add(l),u.renderAll()}return()=>{u.dispose()}},[e]);let C=e=>{b&&(w(e),b.backgroundColor=e,b.renderAll())};return(0,a.jsxs)("div",{className:"flex h-screen bg-[#0f172a] text-white overflow-hidden font-sans",children:[(0,a.jsxs)("div",{className:"w-80 bg-[#1e293b] border-r border-gray-800 flex flex-col shadow-xl z-10",children:[(0,a.jsxs)("div",{className:"p-6 border-b border-gray-800",children:[(0,a.jsx)("h1",{className:"text-xl font-bold bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent",children:"Design Studio"}),(0,a.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Designing for: ",e.name]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[(0,a.jsxs)("section",{children:[(0,a.jsxs)("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[(0,a.jsx)(n,{size:14})," Layers & Content"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("label",{className:"flex flex-col items-center justify-center p-4 bg-[#0f172a] border border-gray-700 rounded-xl cursor-pointer hover:border-blue-500 hover:bg-[#1e293b] transition-all group",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-500/10 flex items-center justify-center mb-2 group-hover:bg-blue-500/20 transition-colors",children:(0,a.jsx)(i,{size:20,className:"text-blue-400"})}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Image"}),(0,a.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{let t=e.target.files?.[0];if(!t||!b)return;let r=new FileReader;r.onload=e=>{let t=e.target?.result;s._V.fromURL(t).then(e=>{e.width&&e.width>400&&e.scaleToWidth(400),b.add(e),b.centerObject(e),b.setActiveObject(e),b.renderAll()})},r.readAsDataURL(t)}})]}),(0,a.jsxs)("button",{onClick:()=>{if(!b)return;let e=new s.DA("Your Brand",{left:100,top:100,fontFamily:"Inter, sans-serif",fill:"#000000",fontSize:40,fontWeight:"bold"});b.add(e),b.centerObject(e),b.setActiveObject(e)},className:"flex flex-col items-center justify-center p-4 bg-[#0f172a] border border-gray-700 rounded-xl hover:border-purple-500 hover:bg-[#1e293b] transition-all group",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-purple-500/10 flex items-center justify-center mb-2 group-hover:bg-purple-500/20 transition-colors",children:(0,a.jsx)(d,{size:20,className:"text-purple-400"})}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Text"})]})]})]}),(0,a.jsxs)("section",{children:[(0,a.jsxs)("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[(0,a.jsx)(c,{size:14})," Background"]}),(0,a.jsx)("div",{className:"grid grid-cols-5 gap-2",children:["#ffffff","#000000","#f8fafc","#ef4444","#f97316","#eab308","#22c55e","#3b82f6","#8b5cf6","#ec4899"].map(e=>(0,a.jsx)("button",{onClick:()=>C(e),className:`w-10 h-10 rounded-lg border-2 transition-transform hover:scale-110 ${k===e?"border-white shadow-lg scale-110":"border-transparent"}`,style:{backgroundColor:e},title:e},e))}),(0,a.jsxs)("div",{className:"mt-3 flex items-center gap-3 p-3 bg-[#0f172a] rounded-lg border border-gray-700",children:[(0,a.jsx)("input",{type:"color",value:k,onChange:e=>C(e.target.value),className:"w-8 h-8 rounded cursor-pointer bg-transparent border-none"}),(0,a.jsx)("span",{className:"text-sm text-gray-400 font-mono",children:k})]})]}),v&&(0,a.jsxs)("section",{className:"animate-in slide-in-from-left-4 fade-in duration-200",children:[(0,a.jsxs)("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[(0,a.jsx)(u,{size:14})," Selection"]}),(0,a.jsxs)("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-xl",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,a.jsx)("span",{className:"text-sm text-red-200",children:"Selected Item"})}),(0,a.jsxs)("button",{onClick:()=>{b&&v&&(b.remove(v),b.discardActiveObject(),b.renderAll())},className:"w-full flex items-center justify-center gap-2 p-2 bg-red-500/20 text-red-400 rounded-lg hover:bg-red-500/30 transition-colors text-sm font-medium",children:[(0,a.jsx)(h,{size:16})," Delete Object"]})]})]})]}),(0,a.jsx)("div",{className:"p-4 border-t border-gray-800 text-xs text-gray-500 text-center",children:"Use mouse to move, scale & rotate"})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col relative bg-[#0f172a] bg-[radial-gradient(#1e293b_1px,transparent_1px)] [background-size:16px_16px]",children:[(0,a.jsxs)("div",{className:"h-16 border-b border-gray-800 flex items-center justify-between px-8 bg-[#0f172a]/80 backdrop-blur-md z-10",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("button",{className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",title:"Undo",children:(0,a.jsx)(x,{size:18})}),(0,a.jsx)("button",{className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",title:"Redo",children:(0,a.jsx)(g,{size:18})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-800 rounded-lg transition-colors flex items-center gap-2",children:[(0,a.jsx)(f,{size:16})," Cancel"]}),(0,a.jsxs)("button",{onClick:()=>{if(b){if(!k||"transparent"===k||""===k)return void alert("Please select a background color before saving. This ensures your ad looks great on the map!");A(!0),setTimeout(()=>{let e=b.toDataURL({format:"png",quality:1,multiplier:2}),r=b.backgroundColor;b.backgroundColor="transparent",b.renderAll();let a=b.toDataURL({format:"png",quality:1,multiplier:2});b.backgroundColor=r,b.renderAll(),t({fullImage:e,overlayImage:a,backgroundColor:k})},500)}},disabled:N,className:"px-6 py-2 text-sm font-bold text-white bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-500 hover:to-blue-400 rounded-lg shadow-lg shadow-blue-500/20 transition-all transform hover:scale-105 active:scale-95 flex items-center gap-2",children:[N?(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):(0,a.jsx)(m,{size:16}),N?"Saving...":"Save Design"]})]})]}),(0,a.jsx)("div",{ref:p,className:"flex-1 overflow-auto flex items-center justify-center p-12",children:(0,a.jsx)("div",{className:"relative shadow-2xl shadow-black/50 rounded-sm overflow-hidden border border-gray-700 bg-[url('https://res.cloudinary.com/dvvqa6xgj/image/upload/v1709138658/checkerboard_v2_q7gq9e.png')] bg-repeat",children:(0,a.jsx)("canvas",{ref:o})})})]})]})}},8340:(e,t,r)=>{r.d(t,{A:()=>i});var a=r(2115);let l=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},s=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:l,className:n="",children:i,iconNode:d,...c},u)=>(0,a.createElement)("svg",{ref:u,...o,width:t,height:t,stroke:e,strokeWidth:l?24*Number(r)/Number(t):r,className:s("lucide",n),...!i&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(c)&&{"aria-hidden":"true"},...c},[...d.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(i)?i:[i]])),i=(e,t)=>{let r=(0,a.forwardRef)(({className:r,...o},i)=>(0,a.createElement)(n,{ref:i,iconNode:t,className:s(`lucide-${l(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,r),...o}));return r.displayName=l(e),r}}}]);